# 基于区块链的电子病历共享系统 - 后端环境配置示例

# 应用环境
NODE_ENV=development
PORT=3001
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# 数据库配置 (PostgreSQL)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=emr_blockchain
DB_USER=emr_user
DB_PASSWORD=emr_password
DB_SSL=false

# Redis缓存配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWT安全配置
JWT_SECRET=your_jwt_secret_key_here_minimum_32_characters
JWT_EXPIRY=24h
REFRESH_TOKEN_SECRET=your_refresh_token_secret_here

# 加密配置
ENCRYPTION_KEY=your_aes_256_encryption_key_here
KMS_MODE=envelope
ENCRYPTION_ALGORITHM=aes-256-gcm

# HSM配置 (Hardware Security Module)
USE_HSM=false
HSM_PROVIDER=mock
HSM_REGION=us-east-1
HSM_ENDPOINT=
HSM_ACCESS_KEY_ID=
HSM_SECRET_ACCESS_KEY=
HSM_TENANT_ID=
HSM_CLIENT_ID=
HSM_CLIENT_SECRET=


# PKCS#11 适配（当 HSM_PROVIDER=pkcs11 时生效）
HSM_STRICT=false
HSM_PKCS11_MODULE_PATH=
HSM_PKCS11_SLOT=0
HSM_PKCS11_PIN=
HSM_PKCS11_KEY_LABEL=emr_default_key

# 审计链码开关（可选，默认回退到 FABRIC_CHAINCODE_NAME）
AUDIT_CHAINCODE_NAME=audit_cc
AUDIT_CHAINCODE_FN_CREATE=CreateAuditLog
AUDIT_CHAINCODE_FN_GET=GetAuditLog

# TLS 1.3配置 (read111.md compliant)
TLS_ENABLED=true
TLS_MIN_VERSION=TLSv1.3
TLS_MAX_VERSION=TLSv1.3
TLS_CERT_PATH=/etc/ssl/certs/server.crt
TLS_KEY_PATH=/etc/ssl/private/server.key
TLS_CA_PATH=/etc/ssl/certs/ca.crt
TLS_DH_PARAM_PATH=/etc/ssl/certs/dhparam.pem
TLS_ENABLE_OCSP=true
TLS_ENABLE_SCT=true

# HSTS配置 (HTTP Strict Transport Security)
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

# Hyperledger Fabric配置
FABRIC_NETWORK_NAME=emr-network
FABRIC_CHANNEL_NAME=emrchannel
FABRIC_CHAINCODE_NAME=emr
FABRIC_MSP_ID=Org1MSP
FABRIC_USER_ID=admin
FABRIC_WALLET_PATH=./wallet
FABRIC_CONNECTION_PROFILE_PATH=./config/connection-org1.json
FABRIC_DISCOVERY_ENABLED=true
FABRIC_NETWORK_TIMEOUT=30000

# IPFS配置
IPFS_URL=http://localhost:5001
IPFS_GATEWAY_URL=http://localhost:8080
IPFS_CLUSTER_URL=http://localhost:9094

# 区块链网络配置
BLOCKCHAIN_NETWORK_ID=emr-blockchain
BLOCKCHAIN_GAS_LIMIT=6000000
BLOCKCHAIN_GAS_PRICE=20000000000

# 监控配置
MONITORING_ENABLED=true
METRICS_PORT=9090
PROMETHEUS_ENABLED=true

# 邮件服务配置
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# 文件上传配置
MAX_FILE_SIZE=10485760
UPLOAD_DIR=./uploads
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,dcm

# 性能配置
REQUEST_TIMEOUT=30000
MAX_CONCURRENT_REQUESTS=100
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=100

# 安全配置
CORS_ORIGIN=http://localhost:3000
HELMET_ENABLED=true
BCRYPT_ROUNDS=12

# API配置
API_VERSION=v1
API_PREFIX=/api

# 外部服务配置
EXTERNAL_API_KEY=your_external_api_key
EXTERNAL_API_URL=https://api.external-service.com

# 备份配置
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# 联邦学习配置
FEDERATED_LEARNING_ENABLED=false
ML_MODEL_PATH=./models
ML_TRAINING_INTERVAL=86400000

# WebSocket配置
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_CONNECTIONS=1000
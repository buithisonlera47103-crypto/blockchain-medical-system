# 部署后管理指南 - Vercel 项目运维

## 🎉 部署成功！接下来做什么？

恭喜！您的区块链医疗记录系统已成功部署到 Vercel。本指南将帮助您：

- 🔗 获取和管理访问链接
- 📊 监控应用性能
- 🔧 日常维护操作
- 🚨 故障排除
- 📈 持续优化

## 🔗 访问链接管理

### 获取部署链接

部署完成后，您将获得以下链接：

#### 1. 生产环境链接
```
https://你的项目名.vercel.app
```

#### 2. 自定义域名（可选）
```
https://你的域名.com
```

#### 3. 预览链接
每次 Git push 都会生成：
```
https://你的项目名-git-分支名-你的用户名.vercel.app
```

### 在 Vercel Dashboard 查看链接

1. 登录 [Vercel Dashboard](https://vercel.com/dashboard)
2. 选择您的项目
3. 在 "Deployments" 标签查看所有部署
4. 点击任意部署查看详细信息和访问链接

### 分享链接给他人

**用于项目提交的标准格式**：

```markdown
## 🔗 项目访问链接

- **生产环境**: https://blockchain-medical-records.vercel.app
- **项目仓库**: https://github.com/你的用户名/blockchain-medical-records
- **部署平台**: Vercel
- **最后更新**: 2024-01-XX

### 功能演示
- 用户注册/登录
- 医疗记录管理
- 数据可视化
- 移动端适配
```

## 📊 性能监控

### Vercel Analytics（推荐）

1. **启用 Analytics**
   - 在项目设置中启用 "Analytics"
   - 查看访问量、性能指标
   - 监控 Core Web Vitals

2. **关键指标监控**
   - **LCP** (Largest Contentful Paint): < 2.5s
   - **FID** (First Input Delay): < 100ms
   - **CLS** (Cumulative Layout Shift): < 0.1

### 自定义监控

在 React 应用中添加性能监控：

```javascript
// src/utils/analytics.js
export const trackPageView = (url) => {
  if (process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {
    // 发送页面访问数据
    console.log('Page view:', url);
  }
};

export const trackError = (error) => {
  if (process.env.REACT_APP_ENABLE_ANALYTICS === 'true') {
    // 发送错误数据
    console.error('Application error:', error);
  }
};
```

## 🔧 日常维护操作

### 1. 代码更新部署

```bash
# 本地开发完成后
git add .
git commit -m "feat: 添加新功能"
git push origin main

# Vercel 自动检测并部署
# 通常 2-5 分钟完成
```

### 2. 环境变量更新

**通过 Dashboard**：
1. 项目设置 → Environment Variables
2. 编辑或添加变量
3. 点击 "Save"
4. 触发重新部署

**通过 CLI**：
```bash
# 安装 Vercel CLI
npm i -g vercel

# 登录
vercel login

# 更新环境变量
vercel env add REACT_APP_NEW_FEATURE

# 重新部署
vercel --prod
```

### 3. 域名管理

**添加自定义域名**：
1. 项目设置 → Domains
2. 添加域名
3. 配置 DNS 记录
4. 等待 SSL 证书生成

**DNS 配置示例**：
```
Type: CNAME
Name: www
Value: cname.vercel-dns.com
```

### 4. 分支管理

**生产分支**：`main` 或 `master`
**预览分支**：`develop`, `staging`, `feature/*`

```bash
# 创建功能分支
git checkout -b feature/new-dashboard

# 开发完成后推送
git push origin feature/new-dashboard

# Vercel 自动创建预览部署
```

## 🚨 故障排除

### 常见问题诊断

#### 1. 部署失败

**检查构建日志**：
1. Vercel Dashboard → 项目 → Deployments
2. 点击失败的部署
3. 查看 "Build Logs"

**常见原因**：
- 依赖安装失败
- TypeScript 类型错误
- 环境变量缺失
- 构建脚本错误

**解决步骤**：
```bash
# 本地测试构建
cd react-app
npm run build

# 检查错误并修复
# 重新推送代码
git add .
git commit -m "fix: 修复构建错误"
git push
```

#### 2. 页面无法访问

**症状**：404 或白屏

**检查项**：
- [ ] Root Directory 设置正确（`react-app`）
- [ ] `public/index.html` 文件存在
- [ ] 路由配置正确
- [ ] 构建产物正常

**解决方案**：
```json
// vercel.json - 添加路由重写
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

#### 3. API 调用失败

**症状**：网络请求错误

**检查项**：
- [ ] `REACT_APP_API_URL` 配置正确
- [ ] 后端服务正常运行
- [ ] CORS 配置正确
- [ ] HTTPS/HTTP 协议匹配

**调试方法**：
```javascript
// 在浏览器控制台测试
fetch(process.env.REACT_APP_API_URL + '/health')
  .then(res => res.json())
  .then(data => console.log('API 响应:', data))
  .catch(err => console.error('API 错误:', err));
```

### 性能问题诊断

#### 1. 加载速度慢

**检查工具**：
- Chrome DevTools → Lighthouse
- [PageSpeed Insights](https://pagespeed.web.dev/)
- Vercel Analytics

**优化建议**：
```javascript
// 代码分割
const LazyComponent = React.lazy(() => import('./LazyComponent'));

// 图片优化
<img 
  src="image.jpg" 
  loading="lazy" 
  alt="描述"
/>

// 缓存优化
// 在 vercel.json 中配置缓存头
```

#### 2. 内存使用过高

**监控方法**：
```javascript
// 添加内存监控
if (process.env.NODE_ENV === 'development') {
  setInterval(() => {
    console.log('Memory usage:', performance.memory);
  }, 10000);
}
```

## 📈 持续优化

### 1. 自动化工作流

**GitHub Actions 示例**：

```yaml
# .github/workflows/deploy.yml
name: Deploy to Vercel

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: |
          cd react-app
          npm ci
          
      - name: Run tests
        run: |
          cd react-app
          npm test -- --coverage --watchAll=false
          
      - name: Build application
        run: |
          cd react-app
          npm run build
```

### 2. 监控告警

**设置告警规则**：
- 部署失败通知
- 性能指标异常
- 错误率超阈值
- 访问量异常

### 3. 备份策略

**代码备份**：
- GitHub 仓库（主要）
- 本地备份
- 云存储备份

**配置备份**：
```bash
# 导出 Vercel 配置
vercel env ls > vercel-env-backup.txt
```

## 📋 日常检查清单

### 每日检查
- [ ] 网站可正常访问
- [ ] 关键功能正常
- [ ] 无明显性能问题

### 每周检查
- [ ] 查看 Analytics 数据
- [ ] 检查错误日志
- [ ] 更新依赖包
- [ ] 性能指标分析

### 每月检查
- [ ] 安全更新
- [ ] 备份验证
- [ ] 容量规划
- [ ] 成本分析

## 🔒 安全管理

### 1. 访问控制

**Vercel 团队管理**：
- 最小权限原则
- 定期审查访问权限
- 使用强密码和 2FA

### 2. 敏感信息保护

```bash
# 定期轮换密钥
# 监控异常访问
# 及时更新依赖
```

### 3. 合规检查

- HTTPS 强制启用
- 安全头部配置
- 数据保护合规

## 📞 支持资源

### 官方文档
- [Vercel 文档](https://vercel.com/docs)
- [React 部署指南](https://create-react-app.dev/docs/deployment/)

### 社区支持
- [Vercel Discord](https://vercel.com/discord)
- [GitHub Issues](https://github.com/vercel/vercel/issues)

### 紧急联系
- Vercel 状态页面：[status.vercel.com](https://status.vercel.com)
- 技术支持：通过 Dashboard 提交工单

## 🎯 成功指标

### 技术指标
- ✅ 部署成功率 > 95%
- ✅ 页面加载时间 < 3s
- ✅ 错误率 < 1%
- ✅ 可用性 > 99.9%

### 业务指标
- 📈 用户访问量
- 📊 功能使用率
- 💬 用户反馈
- 🏆 项目评分

---

**维护难度**: 低  
**时间投入**: 每周 30 分钟  
**重要程度**: 高（确保项目稳定运行）

🎉 **恭喜！您现在拥有一个完全部署并可管理的区块链医疗记录系统！**